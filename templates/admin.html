{% extends "base.html" %}
{% block title %}Admin â€” hellsy.tube{% endblock %}

{% block content %}
<div class="container">
    <h1 class="admin-heading">Admin Dashboard</h1>

    <div class="admin-stats-grid">
        <div class="stat-card">
            <span class="stat-value">{{ stats.total_videos }}</span>
            <span class="stat-label">Published</span>
        </div>
        <div class="stat-card">
            <span class="stat-value">{{ stats.pending }}</span>
            <span class="stat-label">Pending</span>
        </div>
        <div class="stat-card">
            <span class="stat-value">{{ stats.total_users }}</span>
            <span class="stat-label">Users</span>
        </div>
        <div class="stat-card">
            <span class="stat-value">{{ stats.total_views|format_views }}</span>
            <span class="stat-label">Total Views</span>
        </div>
    </div>

    {% if pending %}
    <section class="admin-section">
        <h2>Pending Review ({{ pending|length }})</h2>
        <div class="admin-list">
            {% for v in pending %}
            <div class="admin-item">
                <div class="admin-item-thumb">
                    {% if v.thumbnail %}
                        <img src="/thumbnail/{{ v.thumbnail }}" alt="">
                    {% endif %}
                </div>
                <div class="admin-item-info">
                    <h3>{{ v.title }}</h3>
                    <p>By {{ v.uploader_name }} ({{ v.uploader_email }}) &middot; {{ v.file_size|format_size }} &middot; {{ v.created_at|time_ago }}</p>
                </div>
                <div class="admin-item-actions">
                    <form method="post" action="/admin/publish/{{ v.id }}" style="display:inline">
                        <button class="btn btn-success btn-sm">Publish</button>
                    </form>
                    <form method="post" action="/admin/remove/{{ v.id }}" style="display:inline">
                        <button class="btn btn-danger btn-sm">Remove</button>
                    </form>
                </div>
            </div>
            {% endfor %}
        </div>
    </section>
    {% endif %}

    <section class="admin-section">
        <h2>Published Videos ({{ published|length }})</h2>
        {% if published %}
        <div class="admin-list">
            {% for v in published %}
            <div class="admin-item {% if v.is_featured %}admin-featured{% endif %}">
                <div class="admin-item-thumb">
                    {% if v.thumbnail %}
                        <img src="/thumbnail/{{ v.thumbnail }}" alt="">
                    {% endif %}
                </div>
                <div class="admin-item-info">
                    <h3>{{ v.title }} {% if v.is_featured %}<span class="featured-badge-sm">FEATURED</span>{% endif %}</h3>
                    <p>{{ v.uploader_name }} &middot; {{ v.views|format_views }} views &middot; {{ v.likes_count }} likes</p>
                </div>
                <div class="admin-item-actions">
                    {% if not v.is_featured %}
                    <form method="post" action="/admin/feature/{{ v.id }}" style="display:inline">
                        <button class="btn btn-primary btn-sm">Feature</button>
                    </form>
                    {% endif %}
                    <form method="post" action="/admin/remove/{{ v.id }}" style="display:inline">
                        <button class="btn btn-danger btn-sm">Remove</button>
                    </form>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <p class="empty-msg">No published videos yet.</p>
        {% endif %}
    </section>
</div>
{% endblock %}
